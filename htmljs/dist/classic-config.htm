<html><head><title>Configuration</title><script>function s_ajax(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){4==t.readyState&&(200==t.status?e.success(t.responseText):t.onerror(t.status))},t.ontimeout=function(){void 0!==e.timeout?e.timeout():t.onerror(-1)},t.onerror=function(t){void 0!==e.fail&&e.fail(t)},t.open(e.m,e.url,!0),void 0!==e.data?(t.setRequestHeader("Content-Type",void 0!==e.mime?e.mime:"application/x-www-form-urlencoded"),t.send(e.data)):t.send()}var Q=function(e){return document.querySelector(e)}</script><script>function formatIP(e){return"0.0.0.0"==e?"":e}function verifyIP(e){var t=this.value.split("."),a=!0;if(4==t.length)for(var n=0;n<4;n++){if(parseInt(t[n])>255){a=!1;break}}else a=""==this.value;a?(this.saved=this.value,this.value=formatIP(this.value)):this.value=formatIP(this.saved)}function loadSetting(){s_ajax({url:"config?cfg=1",m:"GET",success:function(e){var t=JSON.parse(e);window.oridata=t,Object.keys(t).map(function(e){var a=Q("input[name="+e+"]");a?a.classList.contains("iptype")?(a.value=formatIP(t[e]),a.saved=t[e],a.onchange=verifyIP):"checkbox"==a.type?a.checked=0!=t[e]:a.value=t[e]:(a=Q("select[name="+e+"]"))&&(a.value=t[e])})},fail:function(e){alert("error getting data:"+e)}})}function waitrestart(){Q("#waitprompt").style.display="block",Q("#inputform").style.display="none",setTimeout(function(){window.location.reload()},15e3)}function save(){var e=document.querySelectorAll("input"),t={},a=!1;Object.keys(e).map(function(n,i){var o;"submit"!=e[i].type&&(e[i].name&&""!=e[i].name&&(o=e[i].classList.contains("iptype")?e[i].saved:"checkbox"==e[i].type?e[i].checked?1:0:e[i].value.trim(),t[e[i].name]=o,window.oridata[e[i].name]==o||e[i].classList.contains("nb")||(a=!0)))});var n=Q("select[name=wifi]");t.wifi=n.value,console.log(JSON.stringify(t)),s_ajax({url:"config"+(a?"":"?nb"),data:"data="+encodeURIComponent(JSON.stringify(t)),m:"POST",success:function(e){a&&waitrestart()},fail:function(e){alert("error saving data:"+e)}})}function load(){Q("#verinfo")&&(Q("#verinfo").innerHTML="v"+JSVERSION),loadSetting()}</script><style>#waitprompt{display:none}</style></head><body onload=load()><div id=waitprompt>Congfiuration saved. Wait for restart.. (note: if the hostname is changed, the page won't be reloaded.)</div><div id=inputform><form action=/setconfig action=post><table><tr><td>LCD auto off</td><td><input name=aoff type=text size=5 maxlength=5 class=nb>seconds</td></tr><tr><td>Title</td><td><input name=title type=text size=12 maxlength=24></td></tr><tr><td>Host/Network Name</td><td><input name=name type=text size=12 maxlength=16></td></tr><tr><td>HTTP Port</td><td><input name=port type=text size=5 maxlength=5></td></tr><tr><td>User Name</td><td><input name=user type=text size=12 maxlength=16></td></tr><tr><td>Password</td><td><input name=pass type=password size=12 maxlength=16></td></tr><tr><td>Always need password</td><td><input type=checkbox name=protect></td></tr><tr><td>Network</td><td><select name=wifi><option value=1>Station</option><option value=2>AP</option><option value=3>Station + AP</option></select></td></tr><tr><td>Fixed IP</td><td><input type=text name=ip size=16 class=iptype></td></tr><tr><td>Gateway</td><td><input type=text name=gw size=16 class=iptype></td></tr><tr><td>Netmask</td><td><input type=text name=mask size=16 class=iptype></td></tr><tr><td>Save Change</td><td><input type=submit name=submit onclick="return save(),!1"></td></tr></table></form></div></body></html>